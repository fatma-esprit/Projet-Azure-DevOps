trigger:
- main

pool:
  name: Default  # Utilisation de ton agent auto-hébergé

steps:
- task: NodeTool@0
  inputs:
    versionSpec: '16.x'
  displayName: 'Installer Node.js'

- script: |
    npm install -g npm@latest  # Mise à jour de npm
    npm install  # Installation des dépendances du projet
    npm rebuild node-sass  # Reconstruction si nécessaire
  displayName: 'Installer les dépendances'

- script: |
    npm run build --configuration production
  workingDirectory: $(Build.SourcesDirectory)
  displayName: 'Construire l’application Angular'

- task: PublishBuildArtifacts@1
  inputs:
    pathToPublish: '$(Build.SourcesDirectory)/dist'
    artifactName: 'drop'
  displayName: 'Publier les artefacts de build'
